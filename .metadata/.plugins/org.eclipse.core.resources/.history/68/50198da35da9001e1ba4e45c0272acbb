package Test;

import javax.swing.*;
import javax.swing.border.Border;
import javax.swing.border.EmptyBorder;
import javax.swing.event.ListSelectionEvent;
import javax.swing.event.ListSelectionListener;
import javax.swing.plaf.basic.BasicScrollBarUI;

import Client.ListClientComponent;
import Server.ServerCore;
import TheSedativePackage.MyTextField;

import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseWheelEvent;
import java.awt.event.MouseWheelListener;
import java.util.concurrent.Flow;

import javax.swing.plaf.basic.BasicScrollBarUI;

class ModernScrollBarUI extends BasicScrollBarUI {

    private final int THUMB_SIZE =100;

    @Override
    protected Dimension getMaximumThumbSize() {
        if (scrollbar.getOrientation() == JScrollBar.VERTICAL) {
            return new Dimension(0, THUMB_SIZE);
        } else {
            return new Dimension(THUMB_SIZE, 0);
        }
    }

    @Override
    protected Dimension getMinimumThumbSize() {
        if (scrollbar.getOrientation() == JScrollBar.VERTICAL) {
            return new Dimension(0, THUMB_SIZE);
        } else {
            return new Dimension(THUMB_SIZE, 0);
        }
    }

    @Override
    protected JButton createIncreaseButton(int i) {
        return new ScrollBarButton();
    }

    @Override
    protected JButton createDecreaseButton(int i) {
        return new ScrollBarButton();
    }

    @Override
    protected void paintTrack(Graphics grphcs, JComponent jc, Rectangle rctngl) {
        Graphics2D g2 = (Graphics2D) grphcs;
        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        int orientation = scrollbar.getOrientation();
        int size;
        int x;
        int y;
        int width;
        int height;
        if (orientation == JScrollBar.VERTICAL) {
            size = rctngl.width / 2;
            x = rctngl.x + ((rctngl.width - size) / 2);
            y = rctngl.y;
            width = size;
            height = rctngl.height;
        } else {
            size = rctngl.height / 2;
            y = rctngl.y + ((rctngl.height - size) / 2);
            x = 0;
            width = rctngl.width;
            height = size;
        }
        g2.setColor(new Color(240, 240, 240, 50));
        g2.fillRect(x, y, width-5, height);
    }

    @Override
    protected void paintThumb(Graphics grphcs, JComponent jc, Rectangle rctngl) {
        Graphics2D g2 = (Graphics2D) grphcs;
        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        int x = rctngl.x;
        int y = rctngl.y;
        int width = rctngl.width;
        int height = rctngl.height;
        if (scrollbar.getOrientation() == JScrollBar.VERTICAL) {
            y += 8;
            height -= 16;
        } else {
            x += 8;
            width -= 16;
        }
        g2.setColor(scrollbar.getForeground());
        g2.fillRoundRect(x, y, width-5, height, 5, 5);
    }

    private class ScrollBarButton extends JButton {

        public ScrollBarButton() {
            setBorder(BorderFactory.createEmptyBorder());
        }

        @Override
        public void paint(Graphics grphcs) {
        }
    }
}


class PanelListCellRenderer implements ListCellRenderer<ListClientComponent> {
	@Override
    public Component getListCellRendererComponent(JList<? extends ListClientComponent> list, ListClientComponent value, int index, boolean isSelected, boolean cellHasFocus) {
//    	Component renderer = (Component) value;
//    	
//    	if (isSelected) {
//            // Customize the appearance of selected cells
////    		renderer.setBackground(Color.BLUE);
//    		renderer.setBackground(new Color(91, 150, 247));
//    		setPanelForeground(renderer, Color.white);
//        } else {
//    		renderer.setBackground(Color.white);
//    		setPanelForeground(renderer, Color.black);
//    	}
//    	
//    	return renderer;
		
		JPanel renderer = new JPanel();
		renderer.setLayout(new BorderLayout());
		renderer.add(value, BorderLayout.CENTER);
		renderer.setPreferredSize(new Dimension(290, 94));
		renderer.setBackground(new Color(248, 250, 255));
		renderer.setBorder(BorderFactory.createEmptyBorder(0, 0, 24, 0));
		
		if (isSelected) {
          // Customize the appearance of selected cells
//  		renderer.setBackground(Color.BLUE);
			value.setBackground(new Color(91, 150, 247));
			setPanelForeground(value, Color.white);
		} else {
			value.setBackground(Color.white);
			setPanelForeground(value, Color.black);
		}
		
		return renderer;
    }
    
    private void setPanelForeground(JPanel panel, Color color) {
    	if (panel instanceof JPanel) {
	    	Component[] components = ((JPanel) panel).getComponents();
	    	for (Component component : components) {
	    		if (component instanceof JLabel) {
	    			((JLabel) component).setForeground(color);
	    		}
	    	}
    	}
    }
    
}


public class TestListModel extends JFrame {
	
	public static void main(String[] args) {
		EventQueue.invokeLater(new Runnable() {
			@Override
			public void run() {
				try {
					TestListModel frame = new TestListModel();
					frame.setVisible(true);
				} catch (Exception e) {
					e.printStackTrace();
				}
				
			}
		});
	}
	
	private Component createSpacer() {
        return Box.createRigidArea(new Dimension(0, 24));
    }
	
	public TestListModel() {
		setSize(1024, 900);
		setLocationRelativeTo(null);
		setDefaultCloseOperation(EXIT_ON_CLOSE);
		setLayout(null);
		
		JPanel p = new JPanel();
		p.setBounds(0, 0, 325, 900);
		p.setLayout(new FlowLayout());
		p.setBackground(new Color(248, 250, 255));
		add(p);
		
		JPanel p2 = new JPanel();
		p2.setBounds(325, 0, 337, 760);
		p2.setLayout(new BorderLayout());
		p2.setBackground(new Color(248, 250, 255));
		add(p2);
		
		
		
		DefaultListModel<ListClientComponent> model = new DefaultListModel<>();
		for (int i = 0; i < 20; i++) {
//			model.addElement(createSpacer());
			model.addElement(new ListClientComponent());
		}
		
		JList<ListClientComponent> list = new JList<>(model);
//		list.setBounds(50,50,300,300);
//		list.setLayout(new BorderLayout());
		
		list.setCellRenderer(new PanelListCellRenderer());
		
//		list.setBorder(null);
		list.setBorder(BorderFactory.createEmptyBorder());
		list.setBackground(new Color(248, 250, 255));
		list.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
		
//		list.setFixedCellHeight(94);
//		list.setFixedCellWidth(290);
		
		JScrollPane scrollPane = new JScrollPane(list);
		scrollPane.setBorder(BorderFactory.createEmptyBorder());
//		scrollPane.setBounds(350, 50, 300, 300);
		scrollPane.setPreferredSize(new Dimension(290, 900));
		scrollPane.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_NEVER);
		scrollPane.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
		
		
		// Create a custom vertical scroll bar
        JScrollBar customScrollBar = new JScrollBar(JScrollBar.VERTICAL);

        // Synchronize the models of the JList and the custom scroll bar
        customScrollBar.setModel(scrollPane.getVerticalScrollBar().getModel());
        customScrollBar.setPreferredSize(new Dimension(10, 760));
        customScrollBar.setForeground(new Color(48, 144, 216));
        customScrollBar.setBackground(new Color(248, 250, 255));
        customScrollBar.setUI(new ModernScrollBarUI());
//        customScrollBar.setBounds(500, 0, 20, 760);
        list.addMouseWheelListener(new MouseWheelListener() {
            @Override
            public void mouseWheelMoved(MouseWheelEvent e) {
                // Adjust the value of the custom scroll bar based on the mouse wheel movement
                customScrollBar.setValue(customScrollBar.getValue() + e.getWheelRotation() * 50);
            }
        });
		
//		p.add(list, BorderLayout.CENTER);
//		add(scrollPane, BorderLayout.EAST);
		p.add(scrollPane);
//		p.add(customScrollBar, FlowLayout.CENTER);
		p2.add(customScrollBar, BorderLayout.WEST);
	}
}
